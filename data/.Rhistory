}
}
get_levels <- function(name){
labels <- c('Dengue virus type 1','Dengue virus type 2','Dengue virus type 3','Dengue virus type 4','Synthetic construct','Zika virus','Phasivirus phasiense','Donggang virus')
if(name == 'LB'){
labels <- c("Dengue virus type 1","Dengue virus type 2","Dengue virus type 3","Dengue virus type 4",'Zika virus','Other (<1% from Total)')
return(labels)
}
if(name == 'LF1'){
labels <- c("Dengue virus type 1","Dengue virus type 3","Dengue virus type 4",'Other (<1% from Total)')
return(labels)
}
if(name == 'LF2'){
labels <- c("Dengue virus type 2",'Other (<1% from Total)')
return(labels)
}
if(name == 'LF_3_4'){
labels <- c("Dengue virus type 1","Dengue virus type 3","Dengue virus type 4",'Other (<1% from Total)')
return(labels)
}
if(name == 'F3_1_2_3'){
labels <- c("Dengue virus type 1","Dengue virus type 2","Dengue virus type 3",'Other (<1% from Total)')
return(labels)
}
if(name == 'F3_4'){
labels <- c("Dengue virus type 4",'Avian metapneumovirus','Other (<1% from Total)')
return(labels)
}
if(name == 'B3_1_2_3'){
labels <- c("Dengue virus type 1","Dengue virus type 2","Dengue virus type 3",'Other (<1% from Total)')
return(labels)
}
if(name == 'B3_4'){
labels <- c("Dengue virus type 4",'Vibrio fumissii','Other (<1% from Total)')
return(labels)
}
if(name == 'FIP1'){
labels <- c("Other (<1% from Total)")
return(labels)
}
if(name == 'FIP2'){
labels <- c("Dengue virus type 1","Dengue virus type 2",'Other (<1% from Total)')
return(labels)
}
if(name == 'FIP3'){
labels <- c("Dengue virus type 1","Dengue virus type 3",'Other (<1% from Total)')
return(labels)
}
if(name == 'FIP4'){
labels <- c("Dengue virus type 4",'Other (<1% from Total)')
return(labels)
}
if(name == 'BIP_1_2_3'){
labels <- c("Dengue virus type 1","Dengue virus type 2","Dengue virus type 3","Dengue virus type 4",'Japanese encephalitis virus','Tembusu virus', 'Usutu virus', 'West Nile virus','Other (<1% from Total)')
return(labels)
}
if(name == 'BIP4'){
labels <- c("Dengue virus type 1","Dengue virus type 2","Dengue virus type 3","Dengue virus type 4",'Japanese encephalitis virus','Tembusu virus', 'Usutu virus', 'West Nile virus','Other (<1% from Total)')
return(labels)
}
if(name == 'ZIKV'){
labels <- c("Zika virus",'Other (<1% from Total)')
return(labels)
}
}
# MAIN
path <- '/home/chombo/Documents/BIONANO/BLAST/data/DENV_PRIMERS/'
all.files <- list.files(path = path)
files <- all.files[grep('FULL_', all.files, ignore.case = TRUE)]
default.colvec <- c("#EA5BEF","#8696F0","#92F056","#F0CF65","#911eb4",'#900C3F','#071952',"#e6194b", "#E36414", "#ffe119", "#4363d8", "#f58231", "#911eb4", "#42d4f4", "#f032e6", "#bfef45", "#fabed4", "#469990", "#dcbeff", "#9a6324", "#fffac8", "#800000", "#aaffc3", "#808000", "#ffd8b1", "#000075", "#a9a9a9")
colvec.2 <- c('#C70039',"#EA5BEF","#92F056","#e6194b", "#3cb44b", "#ffe119", "#4363d8", "#f58231", "#911eb4", "#42d4f4", "#f032e6", "#bfef45", "#fabed4", "#469990", "#dcbeff", "#9a6324", "#fffac8", "#800000", "#aaffc3", "#808000", "#ffd8b1", "#000075", "#a9a9a9")
colvec <- c('#C21292','#E36414','#2CF015','#33BBC5','#900C3F','#071952')
for(file in files){
base <- str_replace(file,'FULL_','')
base <- str_replace(base,'.tsv','')
plotname <- paste(path,'DENV_',base,'.png',sep = "")
df <- get_data(path = path,file = file)
# default.colvec <- get_colvec(base)
# labels <- get_levels(base)
#
# if(base == "BIP_1_2_3" | base == "BIP4"){
#     png(filename = plotname,pointsize = 15,width = 2800,height = 800,res = 200)
# }else{
#     png(filename = plotname,pointsize = 15,width = 2800,height = 700,res = 250)
# }
#
# plot <- ggplot(data = df,aes(fill = factor(organism, levels = c("dengue virus type 1","dengue virus type 2","dengue virus type 3","dengue virus type 4","Acomys russatus","Agaricus bisporus","Agaricus bisporus var. bisporus","Agaricus bisporus var. bisporus H97","Avian metapneumovirus","Conomelus anceps","Crepidodera aurea","Helicoverpa armigera","Helicoverpa zea","Hippocampus zosterae","Homo sapiens","Japanese encephalitis virus","Microcaecilia unicolor","Musa troglodytarum","Neofusicoccum laricinum","Oryzias latipes","Pammene aurita","Pinctada fucata","Pulicaria dysenterica","Rhagoletis pomonella","Rhagoletis zephyria","Solanum lycopersicum","Stenodema calcarata","synthetic construct","Tachystola acroxantha","Tembusu virus","Usutu virus","Vibrio furnissii","West Nile virus","Xenopus tropicalis","Zika virus","other")),x = molecule, y = counts)) +
#   geom_bar(position = position_fill(reverse = TRUE), stat="identity",show.legend = TRUE) +
#   scale_y_continuous(labels = scales::percent) +
#   scale_fill_manual(values = default.colvec, labels = labels) +
#   coord_flip() +
#   xlab("") +
#   ylab("Percentage") +
#   theme_minimal() +
#   guides(fill=guide_legend(title="Taxonomic Diversity"))
#
# print(plot)
# dev.off()
}
for(file in files){
base <- str_replace(file,'FULL_','')
base <- str_replace(base,'.tsv','')
plotname <- paste(path,'DENV_',base,'.png',sep = "")
df <- get_data(path = path,file = file)
# default.colvec <- get_colvec(base)
# labels <- get_levels(base)
#
# if(base == "BIP_1_2_3" | base == "BIP4"){
#     png(filename = plotname,pointsize = 15,width = 2800,height = 800,res = 200)
# }else{
#     png(filename = plotname,pointsize = 15,width = 2800,height = 700,res = 250)
# }
#
# plot <- ggplot(data = df,aes(fill = factor(organism, levels = c("dengue virus type 1","dengue virus type 2","dengue virus type 3","dengue virus type 4","Acomys russatus","Agaricus bisporus","Agaricus bisporus var. bisporus","Agaricus bisporus var. bisporus H97","Avian metapneumovirus","Conomelus anceps","Crepidodera aurea","Helicoverpa armigera","Helicoverpa zea","Hippocampus zosterae","Homo sapiens","Japanese encephalitis virus","Microcaecilia unicolor","Musa troglodytarum","Neofusicoccum laricinum","Oryzias latipes","Pammene aurita","Pinctada fucata","Pulicaria dysenterica","Rhagoletis pomonella","Rhagoletis zephyria","Solanum lycopersicum","Stenodema calcarata","synthetic construct","Tachystola acroxantha","Tembusu virus","Usutu virus","Vibrio furnissii","West Nile virus","Xenopus tropicalis","Zika virus","other")),x = molecule, y = counts)) +
#   geom_bar(position = position_fill(reverse = TRUE), stat="identity",show.legend = TRUE) +
#   scale_y_continuous(labels = scales::percent) +
#   scale_fill_manual(values = default.colvec, labels = labels) +
#   coord_flip() +
#   xlab("") +
#   ylab("Percentage") +
#   theme_minimal() +
#   guides(fill=guide_legend(title="Taxonomic Diversity"))
#
# print(plot)
# dev.off()
}
source("~/Documents/BIONANO/BLAST/bin/data_analysis_R/DENV2_single_div.R")
source("~/Documents/BIONANO/BLAST/bin/data_analysis_R/DENV2_single_div.R")
source("~/Documents/BIONANO/BLAST/bin/data_analysis_R/DENV2_single_div.R")
source("~/Documents/BIONANO/BLAST/bin/data_analysis_R/DENV2_single_div.R")
source("~/Documents/BIONANO/BLAST/bin/data_analysis_R/DENV2_single_div.R")
gc()
setwd(dir = '/home/chombo/Downloads/')
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(MAGS)
source("~/.active-rstudio-document")
View(MAGS)
head(MAGS$ecosystem)
head(MAGS$habitat)
head(MAGS$ecosystem)
source("~/.active-rstudio-document")
head(MAGS$ecosystem)
head(MAGS$ecosystem_category)
source("~/.active-rstudio-document")
View(MAGS.df)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(MAGS.taxa.df)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
MAGS.df[MAGS.df$genome_id == "3300027714_8",]
MAGS.df$ecosystem[MAGS.df$genome_id == "3300027714_8"]
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
MAGS.df$ecosystem[MAGS.df$genome_id == "3300027323_17"]
item
View(mag.taxonomy)
as.vector(mag.taxonomy)
as.vector(mag.taxonomy[[1]])
source("~/.active-rstudio-document")
grep("d_",item)
if (grep("p_",item)) {
append(phylum.arr,item)
}
source("~/.active-rstudio-document")
if if (is.null(item)){
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
df <- read.table("MAGs_test.tsv",sep = "\t")
View(df)
df <- read.table("MAGs_test.tsv",sep = "\t")
df <- read.table("MAGs_test.tsv",sep = "\t")
df <- read.table("MAGs_test.tsv",sep = "\t")
source("~/.active-rstudio-document")
View(df)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(MAGS.df)
source("~/.active-rstudio-document")
View(MAGS.df)
View(MAGS.filteres)
source("~/.active-rstudio-document")
View(MAGS.filtered)
source("~/.active-rstudio-document")
View(MAGS.filtered)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
View(MAGS.filtered)
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
MAGS.filtered %>%
group_by(ecosystem_category) %>%
summarise()
eco.div <- MAGS.filtered %>%
group_by(ecosystem_category) %>%
summarise()
View(eco.div)
table(MAGS.filtered$ecosystem_category)
## Filter diversity by ecosystem type, class, order and family
eco.div <- as.data.frame(table(MAGS.filtered$ecosystem_category))
View(eco.div)
sum(eco.div$Freq)
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
View(fam.div)
sum(fam.div$counts)
View(class.div)
View(order.div)
View(eco.div)
View(fam.div)
View(class.div)
View(eco.div)
View(order.div)
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
View(fam.div)
View(class.div)
View(class.div)
write.table(MAGS.filtered$genome_id,file = "1069MAGS_list.txt",sep = "",row.names = FALSE)
write.table(MAGS.filtered$genome_id,file = "1069MAGS_list.txt",sep = "",row.names = FALSE,quote = FALSE)
write.table(MAGS.filtered$genome_id,file = "1069MAGS_list.txt",sep = "",row.names = FALSE,quote = FALSE,col.names = FALSE)
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/src/R/01_MetadataCleaning.R")
source("~/Documents/SEGOVIA/CAZymes_PULs/src/R/01_MetadataCleaning.R")
source("~/.active-rstudio-document")
View(MAGS.arr)
MAGS.arr[["V1"]]
source("~/.active-rstudio-document")
MAGS.arr
length(MAGS.arr)
source("~/.active-rstudio-document")
df.test <- read.table(paste(MAGS.arr[1],"/",MAGS.arr[1],".matches_evalue.out",sep = ""))
View(df.test)
source("~/.active-rstudio-document")
View(df.test)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(df.temp)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(PULS.df)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(PULS.df)
PULS.df %>%
group_by(MAG) %>%
summarise()
summary()
source("~/.active-rstudio-document")
View(PULSperMAG.df)
View(df.temp)
sum(PULSperMAG.df$Freq)
as.data.frame(table(df.temp$PULs))
test <- as.data.frame(table(df.temp$PULs))
sum(test$Freq)
test <- test[order(test$Var1),]
View(test)
test <- test[order(test$Freq),]
test <- test[order(test$Freq,decreasing = TRUE),]
View(PULSperMAG.df)
View(PULSperMAG.df)
## Get the summary
PULSperMAG.df <- as.data.frame(table(PULS.df$MAG))
colnames(PULSperMAG.df) <- c("MAGs","PULs_Freq")
excludedMAGS <- data.frame(MAGs = c("3300005326_35","3300005370_1","3300017650_9","3300027284_65","3300027607_50"),
PULs_Freq = c(0,0,0,0,0))
PULSperMAG.df <- rbind(PULSperMAG.df,excludedMAGS)
View(PULSperMAG.df)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
## Save the data
write.table(PULSperMAG.df,file = "PULsperMAG.tsv",sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
## PART 2
## Now we are going to separate the diversity according to the taxonomic ranks (class,order,family) and for the ecosystem distribution
## Read the MAGs metadata
MAGS.meta <- read.table(file = "1069_MAGs_metadata.tsv",sep = "\t",header = TRUE)
View(MAGS.meta)
## PART 2
## Now we are going to separate the diversity according to the taxonomic ranks (class,order,family) and for the ecosystem distribution
## Read the MAGs metadata
MAGS.meta <- read.table(file = "1069_MAGs_metadata.tsv",sep = "\t",header = TRUE)
MAGS.meta <- MAGS.meta %>%
select(genome_id,class,order,family,ecosystem_category)
View(MAGS.meta)
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class)
View(class.arr)
source("~/Documents/SEGOVIA/CAZymes_PULs/src/R/01_MetadataCleaning.R")
## PART 2
## Now we are going to separate the diversity according to the taxonomic ranks (class,order,family) and for the ecosystem distribution
## Read the MAGs metadata
MAGS.meta <- read.table(file = "1069_MAGs_metadata.tsv",sep = "\t",header = TRUE)
MAGS.meta <- MAGS.meta %>%
select(genome_id,class,order,family,ecosystem_category)
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class)
View(class.arr)
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class) %>%
order(class)
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class) %>%
order()
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class)
class.arr <- class.arr[order(class.arr$class,decreasing = TRUE),]
class.arr <- class.arr[order(class.arr$class,decreasing = FALSE),]
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class)
class.arr <- class.arr[order(class.arr$class,decreasing = FALSE),]
class.arr
MAGS.meta <- MAGS.meta[,gsub(" ","_",MAGS.meta$ecosystem_category)]
MAGS.meta <- MAGS.meta[gsub(" ","_",MAGS.meta$ecosystem_category),]
## PART 2
## Now we are going to separate the diversity according to the taxonomic ranks (class,order,family) and for the ecosystem distribution
## Read the MAGs metadata
MAGS.meta <- read.table(file = "1069_MAGs_metadata.tsv",sep = "\t",header = TRUE)
MAGS.meta <- MAGS.meta %>%
select(genome_id,class,order,family,ecosystem_category)
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class)
gsub(" ","_",MAGS.meta$ecosystem_category)
MAGS.meta$ecosystem_category <- gsub(" ","_",MAGS.meta$ecosystem_category)
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class)
class.arr <- class.arr[order(class.arr$class,decreasing = FALSE),]
for (class in class.arr) {
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$class == class])[[1]]
}
View(PULS.df)
View(PULSperMAG.df)
for (class in class.arr) {
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$class == class])[[1]]
rawPULs <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
PULs.counts <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
}
View(PULs.counts)
View(rawPULs)
View(rawPULs)
for (class in class.arr) {
## Extract all the MAGs annotated in each Class
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$class == class])[[1]]
## For each MAG, extract all the PUL counts
PULSperMAG.temp <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
## Extract the PULs diversity
rawPULs.temp <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
pulscounts.temp <- as.data.frame(table(rawPULs.temp$PULs))
colnames(pulscounts.temp) <- c("PULs","frequency")
pulscounts.temp <- pulscounts.temp[order(pulscounts.temp$frequency,decreasing = TRUE),]
}
View(rawPULs.temp)
source("~/Documents/SEGOVIA/CAZymes_PULs/src/R/02_PULsCounts.R")
View(PULSperMAG.temp)
View(PULSperMAG.df)
View(PULSperMAG.df)
## PART 2
## Now we are going to separate the diversity according to the taxonomic ranks (class,order,family) and for the ecosystem distribution
## Read the MAGs metadata
MAGS.meta <- read.table(file = "1069_MAGs_metadata.tsv",sep = "\t",header = TRUE)
MAGS.meta <- MAGS.meta %>%
select(genome_id,class,order,family,ecosystem_category)
MAGS.meta$ecosystem_category <- gsub(" ","_",MAGS.meta$ecosystem_category)
## Remove the excluded MAGs
MAGS.meta <- MAGS.meta[!is.element(MAGS.meta$genome_id,c("3300005326_35","3300005370_1","3300017650_9","3300027284_65","3300027607_50")),]
## PULs per Class
class.arr <- MAGS.meta %>%
distinct(class)
class.arr <- class.arr[order(class.arr$class,decreasing = FALSE),]
for (class in class.arr) {
## Extract all the MAGs annotated in each Class
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$class == class])[[1]]
## For each MAG, extract all the PUL counts
PULSperMAG.temp <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
## Extract the PULs diversity
rawPULs.temp <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
pulscounts.temp <- as.data.frame(table(rawPULs.temp$PULs))
colnames(pulscounts.temp) <- c("PULs","frequency")
pulscounts.temp <- pulscounts.temp[order(pulscounts.temp$frequency,decreasing = TRUE),]
}
View(pulscounts.temp)
View(PULSperMAG.temp)
for (class in class.arr) {
## Extract all the MAGs annotated in each Class
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$class == class])[[1]]
## For each MAG, extract all the PUL counts
PULSperMAG.temp <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
## Extract the PULs diversity
rawPULs.temp <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
pulscounts.temp <- as.data.frame(table(rawPULs.temp$PULs))
colnames(pulscounts.temp) <- c("PULs","frequency")
pulscounts.temp <- pulscounts.temp[order(pulscounts.temp$frequency,decreasing = TRUE),]
## Save the data
write.table(PULSperMAG.temp,file = paste("Taxa_Class/",class,"/",class,"_PULsperMAG.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(rawPULs.temp,file = paste("Taxa_Class/",class,"/",class,"_PULsDiversity.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(pulscounts.temp,file = paste("Taxa_Class/",class,"/",class,"_PULsCounts.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
}
for (class in class.arr) {
## Extract all the MAGs annotated in each Class
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$class == class])
## For each MAG, extract all the PUL counts
PULSperMAG.temp <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
## Extract the PULs diversity
rawPULs.temp <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
pulscounts.temp <- as.data.frame(table(rawPULs.temp$PULs))
colnames(pulscounts.temp) <- c("PULs","frequency")
pulscounts.temp <- pulscounts.temp[order(pulscounts.temp$frequency,decreasing = TRUE),]
## Save the data
write.table(PULSperMAG.temp,file = paste("Taxa_Class/",class,"/",class,"_PULsperMAG.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(rawPULs.temp,file = paste("Taxa_Class/",class,"/",class,"_PULsDiversity.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(pulscounts.temp,file = paste("Taxa_Class/",class,"/",class,"_PULsCounts.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
}
View(PULSperMAG.temp)
View(rawPULs.temp)
## PULs per Order
order.arr <- MAGS.meta %>%
distinct(order)
order.arr <- order.arr[order(order.arr$order,decreasing = FALSE),]
for (ord in order.arr) {
## Extract all the MAGs annotated in each Order
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$order == ord])
## For each MAG, extract all the PUL counts
PULSperMAG.temp <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
## Extract the PULs diversity
rawPULs.temp <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
pulscounts.temp <- as.data.frame(table(rawPULs.temp$PULs))
colnames(pulscounts.temp) <- c("PULs","frequency")
pulscounts.temp <- pulscounts.temp[order(pulscounts.temp$frequency,decreasing = TRUE),]
## Save the data
write.table(PULSperMAG.temp,file = paste("Taxa_Order/",ord,"/",ord,"_PULsperMAG.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(rawPULs.temp,file = paste("Taxa_Order/",ord,"/",ord,"_PULsDiversity.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(pulscounts.temp,file = paste("Taxa_Order/",ord,"/",ord,"_PULsCounts.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
}
## PULs per Family
fam.arr <- MAGS.meta %>%
distinct(family)
fam.arr <- fam.arr[order(fam.arr$family,decreasing = FALSE),]
for (fam in fam.arr) {
## Extract all the MAGs annotated in each Family
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$family == fam])
## For each MAG, extract all the PUL counts
PULSperMAG.temp <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
## Extract the PULs diversity
rawPULs.temp <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
pulscounts.temp <- as.data.frame(table(rawPULs.temp$PULs))
colnames(pulscounts.temp) <- c("PULs","frequency")
pulscounts.temp <- pulscounts.temp[order(pulscounts.temp$frequency,decreasing = TRUE),]
## Save the data
write.table(PULSperMAG.temp,file = paste("Taxa_Family/",fam,"/",fam,"_PULsperMAG.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(rawPULs.temp,file = paste("Taxa_Family/",fam,"/",fam,"_PULsDiversity.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(pulscounts.temp,file = paste("Taxa_Family/",fam,"/",fam,"_PULsCounts.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
}
## PULs per Ecosystem
eco.arr <- MAGS.meta %>%
distinct(ecosystem_category)
eco.arr <- eco.arr[order(eco.arr$ecosystem_category,decreasing = FALSE),]
for (eco in eco.arr) {
## Extract all the MAGs annotated in each Ecosystem
mags.arr.temp <- as.vector(MAGS.meta$genome_id[MAGS.meta$ecosystem_category == eco])
## For each MAG, extract all the PUL counts
PULSperMAG.temp <- PULSperMAG.df[is.element(PULSperMAG.df$MAGs,mags.arr.temp),]
## Extract the PULs diversity
rawPULs.temp <- PULS.df[is.element(PULS.df$MAG,mags.arr.temp),]
pulscounts.temp <- as.data.frame(table(rawPULs.temp$PULs))
colnames(pulscounts.temp) <- c("PULs","frequency")
pulscounts.temp <- pulscounts.temp[order(pulscounts.temp$frequency,decreasing = TRUE),]
## Save the data
write.table(PULSperMAG.temp,file = paste("Ecosystem/",eco,"/",eco,"_PULsperMAG.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(rawPULs.temp,file = paste("Ecosystem/",eco,"/",eco,"_PULsDiversity.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
write.table(pulscounts.temp,file = paste("Ecosystem/",eco,"/",eco,"_PULsCounts.tsv",sep = ""),sep = "\t",quote = FALSE,row.names = FALSE,col.names = FALSE)
}
